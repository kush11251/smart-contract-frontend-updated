<form
  [formGroup]="userForm"
  (ngSubmit)="onSubmit()"
  class="max-w-3xl mx-auto p-8 bg-white shadow-2xl rounded-2xl space-y-6"
>
  <h2 class="text-3xl font-bold text-center text-blue-700 mb-6">User Loan Contract</h2>

  <!-- Personal Info -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <div>
      <label class="block font-semibold text-sm text-gray-700">First Name</label>
      <input type="text" formControlName="firstName"
        class="mt-1 w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
      <p *ngIf="userForm.controls['firstName'].invalid && userForm.controls['firstName'].touched"
        class="text-red-500 text-xs mt-1">
        First name is required.
      </p>
    </div>

    <div>
      <label class="block font-semibold text-sm text-gray-700">Middle Name</label>
      <input type="text" formControlName="middleName"
        class="mt-1 w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
    </div>

    <div>
      <label class="block font-semibold text-sm text-gray-700">Last Name</label>
      <input type="text" formControlName="lastName"
        class="mt-1 w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
      <p *ngIf="userForm.controls['lastName'].invalid && userForm.controls['lastName'].touched"
        class="text-red-500 text-xs mt-1">
        Last name is required.
      </p>
    </div>
  </div>

  <!-- Contact & Identity -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div>
      <label class="block font-semibold text-sm text-gray-700">Email</label>
      <input type="email" formControlName="email"
        class="mt-1 w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
      <p *ngIf="userForm.controls['email'].invalid && userForm.controls['email'].touched"
        class="text-red-500 text-xs mt-1">
        Enter a valid email address.
      </p>
    </div>

    <div>
      <label class="block font-semibold text-sm text-gray-700">Date of Birth</label>
      <input type="date" formControlName="dob"
        class="mt-1 w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
      <p *ngIf="userForm.controls['dob'].invalid && userForm.controls['dob'].touched"
        class="text-red-500 text-xs mt-1">
        Date of birth is required.
      </p>
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div>
      <label class="block font-semibold text-sm text-gray-700">PAN</label>
      <input type="text" formControlName="pan" maxlength="10"
        (input)="onPanInput($event)"
        class="mt-1 w-full px-4 py-2 border rounded-lg uppercase tracking-widest focus:outline-none focus:ring-2 focus:ring-blue-500" />
      <p *ngIf="userForm.controls['pan'].invalid && userForm.controls['pan'].touched"
        class="text-red-500 text-xs mt-1">
        Enter a valid PAN (ABCDE1234F).
      </p>
    </div>

    <div>
      <label class="block font-semibold text-sm text-gray-700">Pincode</label>
      <input type="text" formControlName="pincode" maxlength="6"
        class="mt-1 w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
      <p *ngIf="userForm.controls['pincode'].invalid && userForm.controls['pincode'].touched"
        class="text-red-500 text-xs mt-1">
        Enter a valid 6-digit Pincode.
      </p>
    </div>
  </div>

  <!-- Gender -->
  <div>
    <label class="block font-semibold text-sm text-gray-700">Gender</label>
    <div class="flex items-center gap-6 mt-2">
      <label class="inline-flex items-center gap-2">
        <input type="radio" formControlName="gender" value="Male" />
        <span>Male</span>
      </label>
      <label class="inline-flex items-center gap-2">
        <input type="radio" formControlName="gender" value="Female" />
        <span>Female</span>
      </label>
    </div>
    <p *ngIf="userForm.controls['gender'].invalid && userForm.controls['gender'].touched"
      class="text-red-500 text-xs mt-1">
      Gender is required.
    </p>
  </div>

  <!-- Loan Info -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div>
      <label class="block font-semibold text-sm text-gray-700">Loan Type</label>
      <select formControlName="loanType"
        class="mt-1 w-full px-4 py-2 border rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500">
        <option value="">Select Loan Type</option>
        <option value="Home Loan">Home Loan</option>
        <option value="Personal Loan">Personal Loan</option>
        <option value="Small Business Loan">Small Business Loan</option>
        <option value="Loan Against Property">Loan Against Property</option>
      </select>
      <p *ngIf="userForm.controls['loanType'].invalid && userForm.controls['loanType'].touched"
        class="text-red-500 text-xs mt-1">
        Loan type is required.
      </p>
    </div>

    <div>
      <label class="block font-semibold text-sm text-gray-700">Loan Amount</label>
      <input type="number" formControlName="loanAmount" maxlength="10"
        class="mt-1 w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" />
      <p *ngIf="userForm.controls['loanAmount'].invalid && userForm.controls['loanAmount'].touched"
        class="text-red-500 text-xs mt-1">
        Enter a valid loan amount.
      </p>
    </div>
  </div>

  <div>
    <label class="block font-semibold text-sm text-gray-700">Loan Tenure (Years)</label>
    <select formControlName="loanTenure"
      class="mt-1 w-full px-4 py-2 border rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-blue-500">
      <option value="">Select Tenure</option>
      <option *ngFor="let year of [5, 10, 15, 20, 25, 30]" [value]="year">{{ year }} Years</option>
    </select>
    <p *ngIf="userForm.controls['loanTenure'].invalid && userForm.controls['loanTenure'].touched"
      class="text-red-500 text-xs mt-1">
      Select a loan tenure.
    </p>
  </div>

  <!-- Consent Checkboxes -->
  <div class="space-y-2">
    <div>
      <label class="inline-flex items-center">
        <input type="checkbox" formControlName="consent" class="mr-2" />
        <span>I agree to the terms and conditions</span>
      </label>
      <p *ngIf="userForm.controls['consent'].invalid && userForm.controls['consent'].touched"
        class="text-red-500 text-xs mt-1">
        You must agree to the terms.
      </p>
    </div>
  
    <div class="mt-4">
      <label class="inline-flex items-center">
        <input type="checkbox" formControlName="consent2" class="mr-2" />
        <span>Generate Contact and Store in Secure Storage</span>
      </label>
      <p *ngIf="userForm.controls['consent2'].invalid && userForm.controls['consent2'].touched"
        class="text-red-500 text-xs mt-1">
        You must agree to the terms.
      </p>
    </div>
  </div>
  

  <!-- Submit Button -->
  <button
    type="submit"
    [disabled]="userForm.invalid || isLoading"
    class="w-full bg-blue-600 hover:bg-blue-700 transition-colors text-white font-semibold py-3 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed"
  >
    {{ isLoading ? buttonText : "Submit" }}
  </button>
</form>


<!-- Loader Dialog -->
<div
  *ngIf="showLoaderDialog"
  class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
>
  <div class="bg-white rounded-xl p-8 w-80 shadow-xl text-center space-y-4">
    <div class="animate-spin h-8 w-8 mx-auto border-4 border-blue-500 border-t-transparent rounded-full"></div>

    <div>
      <p class="font-semibold text-gray-700">{{ loaderMessage }}</p>
      <p class="text-lg font-mono tracking-widest">{{ loaderDots }}</p>
    </div>
  </div>
</div>
